# 更新日志

## 2024-10-25 - 重大重构 v2.0

### 🎉 核心变更

#### 数据模型重构
- ✅ 周报成为核心实体，事件和决策作为子项关联到周报
- ✅ 事件新增 `level` 字段（重大/中等/日常）
- ✅ 决策新增 `importance`（重要/中等/无关紧要）和 `implementation_status`（落地很好/落地一般/待落地）字段
- ✅ 周报新增多个模块字段：总结、阅读记录、不贰过、其他指标
- ✅ 新增个人信息表（profile）
- ✅ 新增项目表（projects）
- ❌ 删除独立的运动记录表（可通过周报的"其他指标"实现）

#### 后端API重构
- ✅ 重写周报API，支持嵌套创建事件和决策
- ✅ 新增个人信息配置API
- ✅ 新增项目管理API
- ✅ 新增时间轴数据聚合API
- ✅ 优化数据关联和级联删除

#### 前端功能重构

**管理后台：**
- ✅ 简化为3个主要模块：周报管理、个人信息、项目管理
- ✅ 周报录入采用一体化表单设计
  - 基本信息（标题、日期范围、公开设置）
  - 重大事件模块（可添加多条）
  - 决策模块（可添加多条）
  - 总结和想法
  - 阅读学习记录（可选）
  - 不贰过（可选）
  - 其他指标（自定义键值对）
- ✅ 周报列表显示统计信息
- ✅ 个人信息配置页面（头像、简介、技能、联系方式）
- ✅ 项目管理页面（标题、描述、链接、封面、排序）

**公开展示页面：**
- ✅ 顶部个人信息卡片
  - 头像展示
  - 个人简介
  - 技能标签
  - 联系方式链接
- ✅ 精选项目展示区域
  - 卡片式布局
  - 支持封面图
  - 可配置排序
- ✅ 智能筛选时间轴
  - **事件分级筛选**（重大/中等/日常）- 多选
  - **决策重要性筛选**（重要/中等/无关紧要）- 多选
  - **决策落地情况筛选**（落地很好/落地一般/待落地）- 多选
  - 实时更新显示数量
  - 美观的筛选按钮UI

#### UI/UX 改进
- ✅ 导航栏优化，增加品牌标识
- ✅ 侧边栏导航高亮当前页面
- ✅ 表单采用分section设计，提升可读性
- ✅ 时间轴采用不同颜色标识不同级别/重要性
- ✅ 添加空状态提示
- ✅ 优化卡片阴影和过渡动画
- ✅ 响应式设计优化

### 🗑️ 删除的功能
- ❌ 独立的决策管理页面（现在在周报中管理）
- ❌ 独立的事件管理页面（现在在周报中管理）
- ❌ 独立的运动管理页面（改为周报的其他指标）
- ❌ 运动统计图表（可按需恢复）

### 🔄 破坏性变更
- ⚠️ 数据库结构完全重构，旧数据需要迁移
- ⚠️ API接口全部重写，不向后兼容

### 📦 依赖更新
- 更新 `react-router-dom` 到 6.30.1
- 更新 `axios` 到 1.7.9
- 更新 `recharts` 到 2.15.0
- 更新 `date-fns` 到 4.1.0

### 🐛 修复
- 修复 npm 权限问题的文档说明
- 修复端口占用问题的解决方案
- 修复依赖安装冲突

### 📚 文档更新
- ✅ 全新的 README.md
- ✅ 详细的安装指南（INSTALL.md）
- ✅ 更新日志（CHANGELOG.md）
- ✅ 快速开始脚本优化

---

## 迁移指南

### 从 v1.0 迁移到 v2.0

由于数据库结构完全重构，建议：

1. **导出旧数据**（如果需要保留）
2. **删除旧数据库**：`rm server/data.db`
3. **重新启动服务器**（会自动创建新数据库）
4. **重新注册账号**
5. **手动重新录入重要数据**

**注意**：v2.0 的周报模型与 v1.0 完全不同，自动迁移脚本暂未提供。

---

## 技术债务

- [ ] 添加数据迁移脚本
- [ ] 优化大量数据时的性能
- [ ] 添加单元测试
- [ ] 添加 E2E 测试
- [ ] 图片上传功能（目前只支持URL）
- [ ] 移动端体验进一步优化

---

## 贡献者
- 主要开发：AI Assistant
- 需求提供：@sailslow

